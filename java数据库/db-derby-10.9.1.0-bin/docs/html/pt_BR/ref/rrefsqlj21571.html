<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="pt-br" xml:lang="pt-br">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta content="public" name="security" />
<meta content="index,follow" name="Robots" />
<meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<meta content="reference" name="DC.Type" />
<meta name="DC.Title" content="Consulta" />
<meta content="UNION, UNION ALL" name="DC.subject" />
<meta content="UNION, UNION ALL" name="keywords" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj39374.html" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj22771.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj81859.html" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj95081.html" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj80721.html" />
<meta scheme="URI" name="DC.Relation" content="crefsqljrenamestatements.html" />
<meta scheme="URI" name="DC.Relation" content="crefsqlj35312.html" />
<meta scheme="URI" name="DC.Relation" content="rrefcallprocedure.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj13590.html" />
<meta scheme="URI" name="DC.Relation" content="rrefdeclaretemptable.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj35981.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj31783.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj21583.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj32654.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj14854.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj35034.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj40774.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj29840.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj18922.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj40506.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj13658.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj57522.html" />
<meta scheme="URI" name="DC.Relation" content="rrefscalarsubquery.html" />
<meta scheme="URI" name="DC.Relation" content="rrefselectexpression.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj41360.html" />
<meta scheme="URI" name="DC.Relation" content="rreftableexpression.html" />
<meta scheme="URI" name="DC.Relation" content="rreftablesubquery.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj26498.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj11277.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj33602.html" />
<meta scheme="URI" name="DC.Relation" content="rrefsqlj15309.html" />
<meta content="XHTML" name="DC.Format" />
<meta content="rrefsqlj21571" name="DC.Identifier" />
<meta content="pt-br" name="DC.Language" />
<link href="commonltr.css" type="text/css" rel="stylesheet" />
<title>Consulta</title>
</head>
<body id="rrefsqlj21571"><a name="rrefsqlj21571"><!-- --></a>


<h1 class="topictitle1">Consulta</h1>


<div>
<div class="section">
<p>A consulta cria uma tabela virtual baseada em tabelas existentes ou
constantes transformadas em tabelas.</p>

</div>

<div class="section"><h2 class="sectiontitle">Sintaxe</h2>

<pre><strong>{
    ( <em>Consulta</em> ) |
<em>    Consulta</em> INTERSECT [ ALL | DISTINCT ] <em>Consulta</em> |
<em>    Consulta</em> EXCEPT [ ALL | DISTINCT ] <em>Consulta</em> |
<em>    Consulta</em> UNION [ ALL | DISTINCT ] <em>Consulta</em> |
<em>    <a href="rrefselectexpression.html#rrefselectexpression">ExpressãoSeleção</a></em> | <em><a href="rrefsqlj11277.html#rrefsqlj11277">VALUES Expressão</a></em>
}</strong>
</pre>

<p>Pode-se colocar parênteses arbitrariamente em torno das consultas, ou
utilizar parênteses para controlar a ordem de avaliação das operações
INTERSECT, EXCEPT e UNION.
Estas operações são avaliadas da esquerda para a direita quando não existem
parênteses presentes, com exceção das operações INTERSECT, que são avaliadas
antes das operações de UNION e EXCEPT.</p>

</div>

<div class="section"><h2 class="sectiontitle">Linhas duplicadas nos resultados de UNION, INTERSECT e EXCEPT ALL</h2>

<p>As palavras chave ALL e DISTINCT determinam se as linhas duplicadas são
eliminadas do resultado da operação.
Se for especificada a palavra chave DISTINCT, então o resultado não terá linhas
duplicadas.
Se for especificada a palavra chave ALL, então poderão existir linhas duplicadas
no resultado, dependendo da existência de linhas duplicadas na entrada.
DISTINCT é o padrão, portanto se não for especificado nem ALL nem DISTINCT
as linhas duplicadas serão eliminadas.
Por exemplo, UNION constrói um <em>ResultSet</em> intermediário com todas as
linhas das duas consultas, e elimina as linhas duplicadas antes de retornar as
linhas remanescentes.
UNION ALL retorna todas as linhas das duas consultas como resultado.</p>

<div class="p">Dependendo da operação especificada, se o número de cópias de uma
determinada linha na tabela à esquerda for L, e o número de cópias desta linha
na tabela à direita for R, então o número de linhas duplicadas desta
determinada linha contidas na tabela de saída será (assumindo que a palavra
chave ALL foi especificada):
<ul>
<li>UNION: ( L + R ).</li>

<li>EXCEPT: o maior entre ( L – R ) e 0 (zero).</li>

<li>INTERSECT: o menor entre L e R.</li>

</ul>

</div>

</div>

<div class="example"><h2 class="sectiontitle">Exemplos</h2>

<pre><strong><span>-- Uma expressão de seleção</span>
SELECT *
FROM ORG;

<span>-- uma subconsulta</span>
SELECT *
FROM (SELECT COD_CLASSE FROM CLASSE_AGENDA) AS CS;

<span>-- uma subconsulta</span>
SELECT *
FROM (SELECT COD_CLASSE FROM CLASSE_AGENDA) AS CS (COD_CLASSE);

<span>-- uma união
-- retornar todas as linhas das colunas NUM_DEP e GERENTE
-- da tabela ORG
-- e (1,2) e (3,4)
-- NUM_DEP e GERENTE são colunas do tipo SMALLINT.</span>
SELECT NUM_DEP, GERENTE
FROM ORG
UNION ALL
VALUES (1,2), (3,4);

<span>-- uma expressão de valores</span>
VALUES (1,2,3);

<span>-- Listar os números dos empregados (NUM_EMP)
-- de todos os empregados na tabela EMPREGADOS
-- cujo número do departamento (DEP_TRAB) começa por 'E', ou
-- quem está alocado a projetos na tabela ATIV_EMP
-- cujo número do projetor (NUM_PROJ) é igual a
-- 'MA2100', 'MA2110' ou 'MA2112'.</span>
SELECT NUM_EMP
FROM EMPREGADOS
WHERE DEP_TRAB LIKE 'E%'
UNION
SELECT NUM_EMP
FROM ATIV_EMP
WHERE NUM_PROJ IN('MA2100', 'MA2110', 'MA2112');

<span>-- Realizar a mesma consulta do exemplo anterior
-- e "marcar" as linhas da tabela EMPREGADOS com 'emp' e
-- as linhas da tabela ATIV_EMP com 'ativ_emp'.
-- Diferentemente do resultado do exemplo anterior,
-- esta consulta pode retornar o mesmo NUM_EMP mais de uma vez,
-- identificando de que tabela veio pela "marca" associada.</span>
SELECT NUM_EMP, 'emp'
FROM EMPREGADOS
WHERE DEP_TRAB LIKE 'E%'
UNION
SELECT NUM_EMP, 'ativ_emp'
FROM ATIV_EMP
WHERE NUM_PROJ IN('MA2100', 'MA2110', 'MA2112');

<span>-- Realizar a mesma consulta do exemplo anterior,
-- porém utilizando UNION ALL para que as linhas
-- duplicadas não sejam eliminadas.</span>
SELECT NUM_EMP
FROM EMPREGADOS
WHERE DEP_TRAB LIKE 'E%'
UNION ALL
SELECT NUM_EMP
FROM ATIV_EMP
WHERE NUM_PROJ IN('MA2100', 'MA2110', 'MA2112');

<span>-- Realizar a mesma consulta do exemplo anterior,
-- incluindo dois empregados adicionais que no
-- momento não se encontram em nenhuma tabela,
-- e marcar estas linhas como "nova".</span>
SELECT NUM_EMP, 'emp'
FROM EMPREGADOS
WHERE DEP_TRAB LIKE 'E%'
UNION
SELECT NUM_EMP, 'ativ_emp'
FROM ATIV_EMP
WHERE NUM_PROJ IN('MA2100', 'MA2110', 'MA2112')
UNION
VALUES ('NEWAAA', 'nova'), ('NEWBBB', 'nova');</strong>
</pre>

</div>

</div>

<div>
<div class="familylinks">
<div class="parentlink"><strong>Tópico pai:</strong> <a href="crefsqlj39374.html" title="">Instruções</a></div>
</div>
<div class="relconcepts"><strong>Conceitos relacionados</strong><br />
<div><a href="crefsqlj22771.html" title="">Interação com o sistema de dependências</a></div>
<div><a href="crefsqlj95081.html" title="">Instruções CREATE</a></div>
<div><a href="crefsqlj80721.html" title="">Instruções DROP</a></div>
<div><a href="crefsqljrenamestatements.html" title="">Instruções RENAME</a></div>
<div><a href="crefsqlj35312.html" title="">Instruções SET</a></div>
</div>
<div class="relref"><strong>Referências relacionadas</strong><br />
<div><a href="rrefsqlj81859.html" title="">Instrução ALTER TABLE</a></div>
<div><a href="rrefcallprocedure.html" title="">CALL (PROCEDIMENTO)</a></div>
<div><a href="rrefsqlj13590.html" title="">Cláusula CONSTRAINT</a></div>
<div><a href="rrefdeclaretemptable.html" title="">Instrução DECLARE GLOBAL TEMPORARY TABLE</a></div>
<div><a href="rrefsqlj35981.html" title="">Instrução DELETE</a></div>
<div><a href="rrefsqlj31783.html" title="">Cláusula FOR UPDATE</a></div>
<div><a href="rrefsqlj21583.html" title="">Cláusula FROM</a></div>
<div><a href="rrefsqlj32654.html" title="">Cláusula GROUP BY</a></div>
<div><a href="rrefsqlj14854.html" title="">Cláusula HAVING</a></div>
<div><a href="rrefsqlj35034.html" title="">INNER JOIN</a></div>
<div><a href="rrefsqlj40774.html" title="">Instrução INSERT</a></div>
<div><a href="rrefsqlj29840.html" title="">Operação JOIN</a></div>
<div><a href="rrefsqlj18922.html" title="">LEFT OUTER JOIN</a></div>
<div><a href="rrefsqlj40506.html" title="">Instrução LOCK TABLE</a></div>
<div><a href="rrefsqlj13658.html" title="">Cláusula ORDER BY</a></div>
<div><a href="rrefsqlj57522.html" title="">RIGHT OUTER JOIN</a></div>
<div><a href="rrefscalarsubquery.html" title="">SubconsultaEscalar</a></div>
<div><a href="rrefselectexpression.html" title="">ExpressãoSeleção</a></div>
<div><a href="rrefsqlj41360.html" title="">Instrução SELECT</a></div>
<div><a href="rreftableexpression.html" title="">ExpressãoTabela</a></div>
<div><a href="rreftablesubquery.html" title="">SubconsultaTabela</a></div>
<div><a href="rrefsqlj26498.html" title="">Instrução UPDATE</a></div>
<div><a href="rrefsqlj11277.html" title="">VALUES Expressão</a></div>
<div><a href="rrefsqlj33602.html" title="">Cláusula WHERE</a></div>
<div><a href="rrefsqlj15309.html" title="">Cláusula WHERE CURRENT OF</a></div>
</div>
</div>

</body>
</html>
